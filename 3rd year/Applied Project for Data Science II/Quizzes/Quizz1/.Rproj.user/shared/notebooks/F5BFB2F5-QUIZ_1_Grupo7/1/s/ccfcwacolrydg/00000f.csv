"0","Data <-  Data %>% "
"0","  mutate(Datahora = as.Date(Datahora, format = ""%Y:%m:%d"")) %>%"
"0","  mutate(Estação_Ano = case_when("
"0","    (month(Datahora) == 12 & day(Datahora) >= 22) | "
"0","    (month(Datahora) == 1 | month(Datahora) == 2) | "
"0","    (month(Datahora) == 3 & day(Datahora) < 20) ~ ""Inverno"","
"0","    "
"0","    (month(Datahora) >= 3 & month(Datahora) <= 5) | "
"0","    (month(Datahora) == 6 & day(Datahora) < 21) ~ ""Primavera"","
"0","    "
"0","    (month(Datahora) >= 6 & month(Datahora) <= 8) | "
"0","    (month(Datahora) == 9 & day(Datahora) < 23) ~ ""Verão"","
"0","    "
"0","    (month(Datahora) >= 9 & month(Datahora) <= 11) | "
"0","    (month(Datahora) == 12 & day(Datahora) < 22) ~ ""Outono"","
"0","    "
"0","    TRUE ~ ""Inverno"""
"0","  ))"
"0",""
"0","Data$Estação_Ano <- as.factor(Data$Estação_Ano)"
"0","freq_table <- table(Data$Estação_Ano)"
"0","freq_relativa_estacoes <- round((freq_table / sum(freq_table)) * 100, 2)"
"0",""
"0","# Inverno - azul, verão- amarelo, outono - castanho, primavera - verde"
"0","season_colors <- c(""#57aed1"", ""#885435"", ""#228b22"", ""#ffda2c"")"
"0",""
"0","plot_data <- data.frame(freq_relativa_estacoes)"
"0","colnames(plot_data)[1] <- ""Estação"""
"0",""
"0","# Create the ggplot barplot"
"0","ggplot(plot_data, aes(x = Estação, y = Freq, fill = Estação)) +"
"0","   geom_bar(stat = ""identity"") +"
"0","   ylim(0, max(freq_relativa_estacoes) + 10) +"
"0","   geom_text(aes(label = Freq), vjust = -0.5, size = 4) +"
"0","   scale_fill_manual(values = season_colors) +"
"0","   labs(title = ""Frequência Relativa por Estação/Ano"") +"
"0","   xlab(""Estação/Ano"") +"
"0","   ylab(""Frequência Relativa (%)"") +"
"0","   theme_minimal()"
